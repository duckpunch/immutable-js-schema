<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/index.js | immutable-schema API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
<link data-ice="userStyle" rel="stylesheet" href="user/css/0-manual_overrides.css">
</head>
<body class="layout-container">

<header>
  <a href="./">Home</a>
  <a href="identifiers.html">Identifier</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/duckpunch/immutable-js-schema.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav">



<div data-ice="functionWrap">
  <h2><a href="function/">Function</a></h2>
  <ul>
    
  <li data-ice="functionDoc"><span><a href="function/index.html#static-function-Exactly">Exactly</a></span></li>
<li data-ice="functionDoc"><span><a href="function/index.html#static-function-FixedListSchema">FixedListSchema</a></span></li>
<li data-ice="functionDoc"><span><a href="function/index.html#static-function-ListSchema">ListSchema</a></span></li>
<li data-ice="functionDoc"><span><a href="function/index.html#static-function-MapSchema">MapSchema</a></span></li>
<li data-ice="functionDoc"><span><a href="function/index.html#static-function-OneOf">OneOf</a></span></li>
</ul>
</div>






</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/index.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import {chunk, some} from &apos;lodash&apos;;
import {Map, List} from &apos;immutable&apos;;


/**
 * @private
 * Checks a key and value against callables given by a tuple of functions
 *
 * @param {Array} pair
 * @param {*} key
 * @param {*} value
 * @returns {Boolean} whether the key/value match the pair
 */
function checkPair(pair, key, value) {
    const [key_check, value_check] = pair;
    return key_check(key) &amp;&amp; value_check(value);
}


/**
 * Creates a validator function based on passed validator 2-tuples.
 *
 * Key-value entries in the map must satisfy at least one of the validator tuples.
 *
 * TODO: Optional and required key/values
 *
 * @param {function} ...validators functions in pairs to match with each key-value pair
 * @returns {function} function returns true if passed a valid Map
 * @example
 * var isValid = MapSchema(isNumber, Exactly(&apos;hi&apos;), isString, isNumber);
 *
 * isValid(Map().set(5, &apos;hi&apos;)); // true
 * isValid(Map().set(&apos;hi&apos;, &apos;hi&apos;)); // false
 * isValid(Map().set(5, &apos;hi&apos;).set(&apos;foo&apos;, 3)); // true
 */
export function MapSchema(...validators) {
    const pairs = chunk(validators, 2);
    if (validators.length % 2 === 1) {
        throw &apos;Must have even length of validators&apos;;
    }

    function validatePair(value, key) {
        return some(pairs, pair =&gt; checkPair(pair, key, value));
    }

    return function(candidate) {
        if (Map.isMap(candidate)) {
            return candidate.every(validatePair);
        } else {
            return false;
        }
    };
}


/**
 * Generates a function that checks each value matches the validators passed,
 * respective per index.
 *
 * @param {function} ...validators functions, in order, to check each value in the passed list
 * @returns {function} which returns true if each element in list matches in order
 * @example
 * var schema = FixedListSchema(Exactly(&apos;roar&apos;), isNumber);
 *
 * schema(List.of(3));  // false
 * schema(List.of(&apos;roar&apos;));  // false
 * schema(List.of(&apos;fake roar&apos;));  // false
 * schema(List.of(&apos;roar&apos;, 15));  // true
 */
export function FixedListSchema(...validators) {
    return function(candidate) {
        if (List.isList(candidate) &amp;&amp; candidate.size === validators.length) {
            return candidate.every((value, index) =&gt; validators[index](value));
        } else {
            return false;
        }
    };
}


/**
 * Generates a function that checks that each element of a List matches at least
 * one of the passed validators.
 *
 * @param {function} ...validators functions to check each value in the passed list
 * @returns {function} which returns true if each element in list matches at least one validator
 * @example
 * var schema = ListSchema(Exactly(&apos;roar&apos;), isNumber);
 *
 * schema(List.of(3));  // true
 * schema(List.of(&apos;roar&apos;));  // true
 * schema(List.of(3, &apos;fake roar&apos;));  // false
 */
export function ListSchema(...validators) {
    return function(candidate) {
        if (List.isList(candidate)) {
            return candidate.every(
                value =&gt; some(validators, validator =&gt; validator(value))
            );
        } else {
            return false;
        }
    };
}


/**
 * Convenience function that returns a function that validates strict equality.
 *
 * @param {*} value value to test equality
 * @returns {function} evaluates strict equality of passed value
 * @example
 * var isExactly = Exactly(&apos;3&apos;);
 *
 * isExactly(&apos;hi&apos;);  // false
 * isExactly(3);  // false
 * isExactly(&apos;3&apos;);  // true
 */
export function Exactly(value) {
    return candidate =&gt; value === candidate;
}


/**
 * Convenience function that returns a function that validates strict membership
 * in passed arguments.
 *
 * @param {*} ...values collection of values to test membership upon
 * @returns {function} evaluates membership of passed value
 * @example
 * var membership = OneOf(&apos;hi&apos;, &apos;3&apos;, 19);
 *
 * membership(&apos;hi&apos;);  // true
 * membership(3);  // false
 * membership(&apos;not in there&apos;);  // false
 * membership(19);  // true
 */
export function OneOf(...values) {
    return candidate =&gt; some(values, Exactly);
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.2.6)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
